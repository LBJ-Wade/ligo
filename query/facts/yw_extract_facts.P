
% FACT: extract_source(source_id, source_path).
extract_source(1, 'GW150914_tutorial.py').

% FACT: annotation(annotation_id, source_id, line_number, tag, keyword, value).
annotation(1, 1, 101, 'begin', '@BEGIN', 'GRAVITATIONAL_WAVE_DETECTION').
annotation(2, 1, 101, 'desc', '@desc', 'Signal processing in gravitational wave detection.').
annotation(3, 1, 102, 'in', '@IN', 'fn_H1').
annotation(4, 1, 102, 'as', '@as', 'FN_H1').
annotation(5, 1, 103, 'in', '@IN', 'fn_L1').
annotation(6, 1, 103, 'as', '@as', 'FN_L1').
annotation(7, 1, 104, 'param', '@PARAM', 'fs').
annotation(8, 1, 105, 'out', '@OUT', 'GW150914_H1_shifted.wav').
annotation(9, 1, 105, 'as', '@as', 'GW150914_H1_shifted.wav').
annotation(10, 1, 105, 'desc', '@desc', 'H1 shifted wavefile').
annotation(11, 1, 106, 'out', '@OUT', 'GW150914_L1_shifted.wav').
annotation(12, 1, 106, 'as', '@as', 'GW150914_L1_shifted.wav').
annotation(13, 1, 106, 'desc', '@desc', 'L1 shifted wavefile').
annotation(14, 1, 107, 'out', '@OUT', 'GW150914_H1_whitenbp.wav').
annotation(15, 1, 107, 'as', '@as', 'GW150914_H1_whitenbp.wav').
annotation(16, 1, 107, 'desc', '@desc', 'H1 whitened bandpass wavefile').
annotation(17, 1, 108, 'out', '@OUT', 'GW150914_L1_whitenbp.wav').
annotation(18, 1, 108, 'as', '@as', 'GW150914_L1_whitenbp.wav').
annotation(19, 1, 108, 'desc', '@desc', 'L1 whitened bandpass wavefile').
annotation(20, 1, 112, 'begin', '@BEGIN', 'LOAD_DATA').
annotation(21, 1, 112, 'desc', '@desc', 'Load hdf5 data.').
annotation(22, 1, 113, 'in', '@IN', 'fn_H1').
annotation(23, 1, 113, 'as', '@as', 'FN_H1').
annotation(24, 1, 114, 'in', '@IN', 'fn_L1').
annotation(25, 1, 114, 'as', '@as', 'FN_L1').
annotation(26, 1, 115, 'out', '@OUT', 'strain_H1').
annotation(27, 1, 115, 'as', '@as', 'strain_H1').
annotation(28, 1, 116, 'out', '@OUT', 'strain_L1').
annotation(29, 1, 116, 'as', '@as', 'strain_L1').
annotation(30, 1, 136, 'end', '@END', 'LOAD_DATA').
annotation(31, 1, 235, 'begin', '@BEGIN', 'AMPLITUDE_SPECTRAL_DENSITY').
annotation(32, 1, 235, 'desc', '@desc', 'Amplitude spectral density.').
annotation(33, 1, 236, 'in', '@IN', 'strain_H1').
annotation(34, 1, 236, 'as', '@as', 'strain_H1').
annotation(35, 1, 237, 'in', '@IN', 'strain_L1').
annotation(36, 1, 237, 'as', '@as', 'strain_L1').
annotation(37, 1, 238, 'param', '@PARAM', 'fs').
annotation(38, 1, 239, 'out', '@OUT', 'psd_H1').
annotation(39, 1, 239, 'as', '@as', 'PSD_H1').
annotation(40, 1, 240, 'out', '@OUT', 'psd_L1').
annotation(41, 1, 240, 'as', '@as', 'PSD_L1').
annotation(42, 1, 290, 'end', '@END', 'AMPLITUDE_SPECTRAL_DENSITY').
annotation(43, 1, 294, 'begin', '@BEGIN', 'WHITENING').
annotation(44, 1, 294, 'desc', '@desc', 'Whitening helps to suppress the extra noise at low frequencies and at the spectral lines.').
annotation(45, 1, 295, 'in', '@IN', 'psd_H1').
annotation(46, 1, 295, 'as', '@as', 'PSD_H1').
annotation(47, 1, 296, 'in', '@IN', 'psd_L1').
annotation(48, 1, 296, 'as', '@as', 'PSD_L1').
annotation(49, 1, 297, 'out', '@OUT', 'strain_H1_whiten').
annotation(50, 1, 297, 'as', '@as', 'strain_H1_whiten').
annotation(51, 1, 298, 'out', '@OUT', 'strain_L1_whiten').
annotation(52, 1, 298, 'as', '@as', 'strain_L1_whiten').
annotation(53, 1, 326, 'end', '@END', 'WHITENING').
annotation(54, 1, 330, 'begin', '@BEGIN', 'BANDPASSING').
annotation(55, 1, 330, 'desc', '@desc', 'Bandpassing helps to get rid of remaining high frequency noise.').
annotation(56, 1, 331, 'in', '@IN', 'strain_H1_whiten').
annotation(57, 1, 331, 'as', '@as', 'strain_H1_whiten').
annotation(58, 1, 332, 'in', '@IN', 'strain_L1_whiten').
annotation(59, 1, 332, 'as', '@as', 'strain_L1_whiten').
annotation(60, 1, 333, 'out', '@OUT', 'strain_H1_whitenbp').
annotation(61, 1, 333, 'as', '@as', 'strain_H1_whitenbp').
annotation(62, 1, 334, 'out', '@OUT', 'strain_L1_whitenbp').
annotation(63, 1, 334, 'as', '@as', 'strain_L1_whitenbp').
annotation(64, 1, 343, 'end', '@END', 'BANDPASSING').
annotation(65, 1, 348, 'begin', '@BEGIN', 'STRAIN_WAVEFORM').
annotation(66, 1, 348, 'desc', '@desc', 'plot the data after whitening.').
annotation(67, 1, 349, 'in', '@IN', 'strain_H1_whitenbp').
annotation(68, 1, 349, 'as', '@as', 'strain_H1_whitenbp').
annotation(69, 1, 350, 'in', '@IN', 'strain_L1_whitenbp').
annotation(70, 1, 350, 'as', '@as', 'strain_L1_whitenbp').
annotation(71, 1, 370, 'end', '@END', 'STRAIN_WAVEFORM').
annotation(72, 1, 386, 'begin', '@BEGIN', 'SPECTROGRAMS').
annotation(73, 1, 386, 'desc', '@desc', 'plot a short time-frequency spectrogram.').
annotation(74, 1, 387, 'in', '@IN', 'fn_H1').
annotation(75, 1, 387, 'as', '@as', 'strain_H1').
annotation(76, 1, 388, 'in', '@IN', 'fn_L1').
annotation(77, 1, 388, 'as', '@as', 'strain_L1').
annotation(78, 1, 389, 'param', '@PARAM', 'fs').
annotation(79, 1, 390, 'out', '@OUT', 'strain_H1_specgram').
annotation(80, 1, 391, 'out', '@OUT', 'strain_L1_specgram').
annotation(81, 1, 442, 'end', '@END', 'SPECTROGRAMS').
annotation(82, 1, 455, 'begin', '@BEGIN', 'SPECTROGRAMS').
annotation(83, 1, 455, 'desc', '@desc', 'plot a short time-frequency spectrogram.').
annotation(84, 1, 456, 'in', '@IN', 'strain_H1_whiten').
annotation(85, 1, 456, 'as', '@as', 'strain_H1_whiten').
annotation(86, 1, 457, 'in', '@IN', 'strain_L1_whiten').
annotation(87, 1, 457, 'as', '@as', 'strain_L1_whiten').
annotation(88, 1, 458, 'param', '@PARAM', 'fs').
annotation(89, 1, 497, 'end', '@END', 'SPECTROGRAMS').
annotation(90, 1, 510, 'begin', '@BEGIN', 'FILTER_COEFS').
annotation(91, 1, 510, 'desc', '@desc', 'Filter the signal in the time domain, using bandpassing.').
annotation(92, 1, 511, 'param', '@PARAM', 'fs').
annotation(93, 1, 512, 'out', '@OUT', 'coefs').
annotation(94, 1, 512, 'as', '@as', 'COEFFICIENTS').
annotation(95, 1, 600, 'end', '@END', 'FILTER_COEFS').
annotation(96, 1, 606, 'begin', '@BEGIN', 'FILTER_DATA').
annotation(97, 1, 606, 'desc', '@desc', 'Filter the data.').
annotation(98, 1, 607, 'in', '@IN', 'fn_H1').
annotation(99, 1, 607, 'as', '@as', 'strain_H1').
annotation(100, 1, 608, 'in', '@IN', 'fn_L1').
annotation(101, 1, 608, 'as', '@as', 'strain_L1').
annotation(102, 1, 609, 'in', '@IN', 'coefs').
annotation(103, 1, 609, 'as', '@as', 'COEFFICIENTS').
annotation(104, 1, 610, 'out', '@OUT', 'strain_H1_filt').
annotation(105, 1, 610, 'as', '@as', 'strain_H1_filt').
annotation(106, 1, 611, 'out', '@OUT', 'strain_L1_filt').
annotation(107, 1, 611, 'as', '@as', 'strain_L1_filt').
annotation(108, 1, 686, 'end', '@END', 'FILTER_DATA').
annotation(109, 1, 696, 'begin', '@BEGIN', 'STRAIN_WAVEFORM').
annotation(110, 1, 696, 'desc', '@desc', 'plot the data.').
annotation(111, 1, 697, 'in', '@IN', 'strain_H1_filt').
annotation(112, 1, 697, 'as', '@as', 'strain_H1_filt').
annotation(113, 1, 698, 'in', '@IN', 'strain_L1_filt').
annotation(114, 1, 698, 'as', '@as', 'strain_L1_filt').
annotation(115, 1, 699, 'out', '@OUT', 'strain_H1_filt_waveform').
annotation(116, 1, 699, 'as', '@as', 'strain_H1_waveform').
annotation(117, 1, 700, 'out', '@OUT', 'strain_L1_filt_waveform').
annotation(118, 1, 700, 'as', '@as', 'strain_L1_waveform').
annotation(119, 1, 730, 'end', '@END', 'STRAIN_WAVEFORM').
annotation(120, 1, 747, 'begin', '@BEGIN', 'WAVE_FILE_GENERATOR').
annotation(121, 1, 747, 'desc', '@desc', 'Make sound files.').
annotation(122, 1, 748, 'in', '@IN', 'strain_H1_whitenbp').
annotation(123, 1, 748, 'as', '@as', 'strain_H1_whitenbp').
annotation(124, 1, 749, 'in', '@IN', 'strain_L1_whitenbp').
annotation(125, 1, 749, 'as', '@as', 'strain_L1_whitenbp').
annotation(126, 1, 750, 'out', '@OUT', 'GW150914_H1_whitenbp.wav').
annotation(127, 1, 750, 'as', '@as', 'GW150914_H1_whitenbp.wav').
annotation(128, 1, 751, 'out', '@OUT', 'GW150914_L1_whitenbp.wav').
annotation(129, 1, 751, 'as', '@as', 'GW150914_L1_whitenbp.wav').
annotation(130, 1, 781, 'end', '@END', 'WAVE_FILE_GENERATOR').
annotation(131, 1, 799, 'begin', '@BEGIN', 'SHIFT_FREQUENCY_BANDPASSED').
annotation(132, 1, 799, 'desc', '@desc', 'Shifts frequency of a band-passed signal.').
annotation(133, 1, 800, 'in', '@IN', 'strain_H1_whitenbp').
annotation(134, 1, 800, 'as', '@as', 'strain_H1_whitenbp').
annotation(135, 1, 801, 'in', '@IN', 'strain_L1_whitenbp').
annotation(136, 1, 801, 'as', '@as', 'strain_L1_whitenbp').
annotation(137, 1, 802, 'out', '@OUT', 'strain_H1_shifted').
annotation(138, 1, 802, 'as', '@as', 'strain_H1_shifted').
annotation(139, 1, 803, 'out', '@OUT', 'strain_L1_shifted').
annotation(140, 1, 803, 'as', '@as', 'strain_L1_shifted').
annotation(141, 1, 830, 'end', '@END', 'SHIFT_FREQUENCY_BANDPASSED').
annotation(142, 1, 836, 'begin', '@BEGIN', 'WAVE_FILE_GENERATOR').
annotation(143, 1, 836, 'desc', '@desc', 'Make sound files.').
annotation(144, 1, 837, 'in', '@IN', 'strain_H1_shifted').
annotation(145, 1, 837, 'as', '@as', 'strain_H1_shifted').
annotation(146, 1, 838, 'in', '@IN', 'strain_L1_shifted').
annotation(147, 1, 838, 'as', '@as', 'strain_L1_shifted').
annotation(148, 1, 839, 'out', '@OUT', 'GW150914_H1_shifted.wav').
annotation(149, 1, 839, 'as', '@as', 'GW150914_H1_shifted.wav').
annotation(150, 1, 840, 'out', '@OUT', 'GW150914_L1_shifted.wav').
annotation(151, 1, 840, 'as', '@as', 'GW150914_L1_shifted.wav').
annotation(152, 1, 850, 'end', '@END', 'WAVE_FILE_GENERATOR').
annotation(153, 1, 1026, 'end', '@END', 'GRAVITATIONAL_WAVE_DETECTION').

% FACT: annotation_qualifies(qualifying_annotation_id, primary_annotation_id).
annotation_qualifies(2, 1).
annotation_qualifies(4, 3).
annotation_qualifies(6, 5).
annotation_qualifies(9, 8).
annotation_qualifies(10, 8).
annotation_qualifies(12, 11).
annotation_qualifies(13, 11).
annotation_qualifies(15, 14).
annotation_qualifies(16, 14).
annotation_qualifies(18, 17).
annotation_qualifies(19, 17).
annotation_qualifies(21, 20).
annotation_qualifies(23, 22).
annotation_qualifies(25, 24).
annotation_qualifies(27, 26).
annotation_qualifies(29, 28).
annotation_qualifies(32, 31).
annotation_qualifies(34, 33).
annotation_qualifies(36, 35).
annotation_qualifies(39, 38).
annotation_qualifies(41, 40).
annotation_qualifies(44, 43).
annotation_qualifies(46, 45).
annotation_qualifies(48, 47).
annotation_qualifies(50, 49).
annotation_qualifies(52, 51).
annotation_qualifies(55, 54).
annotation_qualifies(57, 56).
annotation_qualifies(59, 58).
annotation_qualifies(61, 60).
annotation_qualifies(63, 62).
annotation_qualifies(66, 65).
annotation_qualifies(68, 67).
annotation_qualifies(70, 69).
annotation_qualifies(73, 72).
annotation_qualifies(75, 74).
annotation_qualifies(77, 76).
annotation_qualifies(83, 82).
annotation_qualifies(85, 84).
annotation_qualifies(87, 86).
annotation_qualifies(91, 90).
annotation_qualifies(94, 93).
annotation_qualifies(97, 96).
annotation_qualifies(99, 98).
annotation_qualifies(101, 100).
annotation_qualifies(103, 102).
annotation_qualifies(105, 104).
annotation_qualifies(107, 106).
annotation_qualifies(110, 109).
annotation_qualifies(112, 111).
annotation_qualifies(114, 113).
annotation_qualifies(116, 115).
annotation_qualifies(118, 117).
annotation_qualifies(121, 120).
annotation_qualifies(123, 122).
annotation_qualifies(125, 124).
annotation_qualifies(127, 126).
annotation_qualifies(129, 128).
annotation_qualifies(132, 131).
annotation_qualifies(134, 133).
annotation_qualifies(136, 135).
annotation_qualifies(138, 137).
annotation_qualifies(140, 139).
annotation_qualifies(143, 142).
annotation_qualifies(145, 144).
annotation_qualifies(147, 146).
annotation_qualifies(149, 148).
annotation_qualifies(151, 150).
